# Tracing

<!--introduced_in=v7.7.0-->

Trace Event provides a mechanism to centralize tracing information generated by
V8, Node.js core, and userspace code.

Tracing can be enabled either by using the `--trace-event-categories` flag
followed by a list of comma separated category names, or by using the
`trace_events.setTracingCategories()` method.

The available categories are:

* `node`
* `node.async_hooks` - Enables capture of detailed async_hooks trace data.
* `node.perf` - Enables capture of [Performance API] measurements.
  * `node.perf.usertiming` - Enables capture of only Performance API User Timing
    measures and marks.
  * `node.perf.timerify` - Enables capture of only Performance API timerify
    measurements.
* `v8`

```txt
node --trace-event-categories v8,node,node.async_hooks server.js
```

```js
const trace_events = require('trace_events');
trace_events.setTracingCategories('v8,node,node.async_hooks');
```

Running Node.js with tracing enabled will produce log files that can be opened
in the [`chrome://tracing`][] tab of Chrome.

The logging file is by default called `node_trace.${rotation}.log`, where
`${rotation}` is an incrementing log-rotation id. The filepath pattern can
be specified with `--trace-event-file-pattern` that accepts a template
string that supports `${rotation}` and `${pid}`. For example:

```txt
node --trace-events-enabled --trace-event-file-pattern '${pid}-${rotation}.log' server.js
```

Starting with Node.js 10.0.0, the tracing system uses the same time source
as the one used by `process.hrtime()`
however the trace-event timestamps are expressed in microseconds,
unlike `process.hrtime()` which returns nanoseconds.

## The `trace_events` module

The `trace_events` module may be used to turn trace event reporting on and off.

It is accessible using `require('trace_events')`.

### trace_events.setTracingCategories(categories)

* `categories` [string] A comma-separated list of category names. If
  `categories` is `undefined`, `null`, or an empty string, capture of trace
  events will be stopped.

Sets the currently enabled trace event category names and enables trace event
capture.

An error will be thrown if trace event support is not enabled in the Node.js
binary.

### trace_events.getTracingCategories()

* Return: [string]

Returns the current list of category names as a comma-separated list or
`undefined`.

```js
const trace_events = require('trace_events');
console.log(trace_events.getTracingCategories());
```

[`chrome://tracing`]: https://www.chromium.org/developers/how-tos/trace-event-profiling-tool
[Performance API]: perf_hooks.html
