// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
'use strict';var cov_2h7cgo1yjz=function(){var path='_tls_common.js',hash='1e88ab9fbe639b343bccb8a5d2d07cd3a4a5d132',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'_tls_common.js',statementMap:{'0':{start:{line:24,column:28},end:{line:24,column:51}},'1':{start:{line:25,column:30},end:{line:25,column:60}},'2':{start:{line:26,column:12},end:{line:26,column:26}},'3':{start:{line:27,column:15},end:{line:27,column:41}},'4':{start:{line:30,column:4},end:{line:30,column:71}},'5':{start:{line:33,column:13},end:{line:33,column:17}},'6':{start:{line:35,column:16},end:{line:35,column:41}},'7':{start:{line:36,column:28},end:{line:36,column:49}},'8':{start:{line:39,column:2},end:{line:41,column:3}},'9':{start:{line:40,column:4},end:{line:40,column:69}},'10':{start:{line:43,column:2},end:{line:53,column:3}},'11':{start:{line:44,column:4},end:{line:44,column:27}},'12':{start:{line:46,column:4},end:{line:46,column:45}},'13':{start:{line:48,column:4},end:{line:52,column:5}},'14':{start:{line:49,column:6},end:{line:49,column:40}},'15':{start:{line:51,column:6},end:{line:51,column:26}},'16':{start:{line:55,column:2},end:{line:55,column:60}},'17':{start:{line:55,column:21},end:{line:55,column:60}},'18':{start:{line:59,column:2},end:{line:63,column:6}},'19':{start:{line:60,column:4},end:{line:63,column:6}},'20':{start:{line:66,column:0},end:{line:66,column:38}},'21':{start:{line:69,column:0},end:{line:201,column:2}},'22':{start:{line:70,column:2},end:{line:70,column:29}},'23':{start:{line:70,column:16},end:{line:70,column:29}},'24':{start:{line:72,column:22},end:{line:72,column:43}},'25':{start:{line:73,column:2},end:{line:74,column:53}},'26':{start:{line:74,column:4},end:{line:74,column:53}},'27':{start:{line:76,column:10},end:{line:76,column:75}},'28':{start:{line:80,column:2},end:{line:80,column:24}},'29':{start:{line:80,column:15},end:{line:80,column:24}},'30':{start:{line:84,column:11},end:{line:84,column:21}},'31':{start:{line:85,column:2},end:{line:98,column:3}},'32':{start:{line:86,column:4},end:{line:95,column:5}},'33':{start:{line:87,column:6},end:{line:91,column:7}},'34':{start:{line:88,column:8},end:{line:88,column:20}},'35':{start:{line:89,column:8},end:{line:89,column:35}},'36':{start:{line:90,column:8},end:{line:90,column:33}},'37':{start:{line:93,column:6},end:{line:93,column:32}},'38':{start:{line:94,column:6},end:{line:94,column:30}},'39':{start:{line:97,column:4},end:{line:97,column:29}},'40':{start:{line:100,column:13},end:{line:100,column:25}},'41':{start:{line:101,column:2},end:{line:112,column:3}},'42':{start:{line:102,column:4},end:{line:111,column:5}},'43':{start:{line:103,column:6},end:{line:107,column:7}},'44':{start:{line:104,column:8},end:{line:104,column:22}},'45':{start:{line:105,column:8},end:{line:105,column:37}},'46':{start:{line:106,column:8},end:{line:106,column:31}},'47':{start:{line:109,column:6},end:{line:109,column:36}},'48':{start:{line:110,column:6},end:{line:110,column:30}},'49':{start:{line:118,column:12},end:{line:118,column:23}},'50':{start:{line:119,column:19},end:{line:119,column:37}},'51':{start:{line:120,column:2},end:{line:133,column:3}},'52':{start:{line:121,column:4},end:{line:132,column:5}},'53':{start:{line:122,column:6},end:{line:128,column:7}},'54':{start:{line:123,column:8},end:{line:123,column:21}},'55':{start:{line:125,column:21},end:{line:125,column:78}},'56':{start:{line:126,column:8},end:{line:126,column:36}},'57':{start:{line:127,column:8},end:{line:127,column:60}},'58':{start:{line:130,column:6},end:{line:130,column:34}},'59':{start:{line:131,column:6},end:{line:131,column:40}},'60':{start:{line:135,column:2},end:{line:138,column:46}},'61':{start:{line:136,column:4},end:{line:136,column:42}},'62':{start:{line:138,column:4},end:{line:138,column:46}},'63':{start:{line:140,column:2},end:{line:143,column:46}},'64':{start:{line:141,column:4},end:{line:141,column:51}},'65':{start:{line:142,column:7},end:{line:143,column:46}},'66':{start:{line:143,column:4},end:{line:143,column:46}},'67':{start:{line:145,column:2},end:{line:149,column:3}},'68':{start:{line:146,column:20},end:{line:146,column:57}},'69':{start:{line:147,column:4},end:{line:148,column:54}},'70':{start:{line:148,column:6},end:{line:148,column:54}},'71':{start:{line:151,column:2},end:{line:159,column:3}},'72':{start:{line:152,column:4},end:{line:158,column:5}},'73':{start:{line:153,column:6},end:{line:155,column:7}},'74':{start:{line:154,column:8},end:{line:154,column:41}},'75':{start:{line:157,column:6},end:{line:157,column:36}},'76':{start:{line:161,column:2},end:{line:163,column:3}},'77':{start:{line:162,column:4},end:{line:162,column:60}},'78':{start:{line:165,column:2},end:{line:190,column:3}},'79':{start:{line:166,column:4},end:{line:167,column:33}},'80':{start:{line:167,column:6},end:{line:167,column:33}},'81':{start:{line:169,column:4},end:{line:189,column:5}},'82':{start:{line:170,column:6},end:{line:180,column:7}},'83':{start:{line:171,column:20},end:{line:171,column:34}},'84':{start:{line:172,column:20},end:{line:172,column:43}},'85':{start:{line:173,column:20},end:{line:173,column:38}},'86':{start:{line:174,column:27},end:{line:174,column:63}},'87':{start:{line:175,column:8},end:{line:179,column:9}},'88':{start:{line:176,column:10},end:{line:176,column:63}},'89':{start:{line:178,column:10},end:{line:178,column:36}},'90':{start:{line:182,column:18},end:{line:182,column:44}},'91':{start:{line:183,column:25},end:{line:183,column:43}},'92':{start:{line:184,column:6},end:{line:188,column:7}},'93':{start:{line:185,column:8},end:{line:185,column:61}},'94':{start:{line:187,column:8},end:{line:187,column:34}},'95':{start:{line:195,column:2},end:{line:198,column:3}},'96':{start:{line:196,column:4},end:{line:196,column:23}},'97':{start:{line:197,column:4},end:{line:197,column:35}},'98':{start:{line:200,column:2},end:{line:200,column:11}},'99':{start:{line:203,column:0},end:{line:225,column:2}},'100':{start:{line:204,column:2},end:{line:205,column:16}},'101':{start:{line:205,column:4},end:{line:205,column:16}},'102':{start:{line:207,column:2},end:{line:207,column:61}},'103':{start:{line:207,column:24},end:{line:207,column:61}},'104':{start:{line:208,column:2},end:{line:210,column:3}},'105':{start:{line:209,column:4},end:{line:209,column:72}},'106':{start:{line:211,column:2},end:{line:211,column:64}},'107':{start:{line:211,column:25},end:{line:211,column:64}},'108':{start:{line:212,column:2},end:{line:223,column:3}},'109':{start:{line:213,column:15},end:{line:213,column:27}},'110':{start:{line:214,column:4},end:{line:214,column:39}},'111':{start:{line:217,column:4},end:{line:222,column:7}},'112':{start:{line:218,column:6},end:{line:221,column:34}},'113':{start:{line:219,column:8},end:{line:219,column:36}},'114':{start:{line:221,column:8},end:{line:221,column:34}},'115':{start:{line:224,column:2},end:{line:224,column:11}}},fnMap:{'0':{name:'SecureContext',decl:{start:{line:38,column:9},end:{line:38,column:22}},loc:{start:{line:38,column:63},end:{line:56,column:1}},line:38},'1':{name:'validateKeyCert',decl:{start:{line:58,column:9},end:{line:58,column:24}},loc:{start:{line:58,column:38},end:{line:64,column:1}},line:58},'2':{name:'createSecureContext',decl:{start:{line:69,column:39},end:{line:69,column:58}},loc:{start:{line:69,column:77},end:{line:201,column:1}},line:69},'3':{name:'translatePeerCertificate',decl:{start:{line:203,column:44},end:{line:203,column:68}},loc:{start:{line:203,column:72},end:{line:225,column:1}},line:203},'4':{name:'(anonymous_4)',decl:{start:{line:217,column:48},end:{line:217,column:49}},loc:{start:{line:217,column:72},end:{line:222,column:5}},line:217}},branchMap:{'0':{loc:{start:{line:39,column:2},end:{line:41,column:3}},type:'if',locations:[{start:{line:39,column:2},end:{line:41,column:3}},{start:{line:39,column:2},end:{line:41,column:3}}],line:39},'1':{loc:{start:{line:43,column:2},end:{line:53,column:3}},type:'if',locations:[{start:{line:43,column:2},end:{line:53,column:3}},{start:{line:43,column:2},end:{line:53,column:3}}],line:43},'2':{loc:{start:{line:48,column:4},end:{line:52,column:5}},type:'if',locations:[{start:{line:48,column:4},end:{line:52,column:5}},{start:{line:48,column:4},end:{line:52,column:5}}],line:48},'3':{loc:{start:{line:55,column:2},end:{line:55,column:60}},type:'if',locations:[{start:{line:55,column:2},end:{line:55,column:60}},{start:{line:55,column:2},end:{line:55,column:60}}],line:55},'4':{loc:{start:{line:59,column:2},end:{line:63,column:6}},type:'if',locations:[{start:{line:59,column:2},end:{line:63,column:6}},{start:{line:59,column:2},end:{line:63,column:6}}],line:59},'5':{loc:{start:{line:59,column:6},end:{line:59,column:60}},type:'binary-expr',locations:[{start:{line:59,column:6},end:{line:59,column:31}},{start:{line:59,column:35},end:{line:59,column:60}}],line:59},'6':{loc:{start:{line:70,column:2},end:{line:70,column:29}},type:'if',locations:[{start:{line:70,column:2},end:{line:70,column:29}},{start:{line:70,column:2},end:{line:70,column:29}}],line:70},'7':{loc:{start:{line:73,column:2},end:{line:74,column:53}},type:'if',locations:[{start:{line:73,column:2},end:{line:74,column:53}},{start:{line:73,column:2},end:{line:74,column:53}}],line:73},'8':{loc:{start:{line:80,column:2},end:{line:80,column:24}},type:'if',locations:[{start:{line:80,column:2},end:{line:80,column:24}},{start:{line:80,column:2},end:{line:80,column:24}}],line:80},'9':{loc:{start:{line:85,column:2},end:{line:98,column:3}},type:'if',locations:[{start:{line:85,column:2},end:{line:98,column:3}},{start:{line:85,column:2},end:{line:98,column:3}}],line:85},'10':{loc:{start:{line:86,column:4},end:{line:95,column:5}},type:'if',locations:[{start:{line:86,column:4},end:{line:95,column:5}},{start:{line:86,column:4},end:{line:95,column:5}}],line:86},'11':{loc:{start:{line:101,column:2},end:{line:112,column:3}},type:'if',locations:[{start:{line:101,column:2},end:{line:112,column:3}},{start:{line:101,column:2},end:{line:112,column:3}}],line:101},'12':{loc:{start:{line:102,column:4},end:{line:111,column:5}},type:'if',locations:[{start:{line:102,column:4},end:{line:111,column:5}},{start:{line:102,column:4},end:{line:111,column:5}}],line:102},'13':{loc:{start:{line:120,column:2},end:{line:133,column:3}},type:'if',locations:[{start:{line:120,column:2},end:{line:133,column:3}},{start:{line:120,column:2},end:{line:133,column:3}}],line:120},'14':{loc:{start:{line:121,column:4},end:{line:132,column:5}},type:'if',locations:[{start:{line:121,column:4},end:{line:132,column:5}},{start:{line:121,column:4},end:{line:132,column:5}}],line:121},'15':{loc:{start:{line:125,column:21},end:{line:125,column:78}},type:'cond-expr',locations:[{start:{line:125,column:65},end:{line:125,column:72}},{start:{line:125,column:75},end:{line:125,column:78}}],line:125},'16':{loc:{start:{line:125,column:21},end:{line:125,column:62}},type:'binary-expr',locations:[{start:{line:125,column:21},end:{line:125,column:37}},{start:{line:125,column:41},end:{line:125,column:62}}],line:125},'17':{loc:{start:{line:127,column:30},end:{line:127,column:58}},type:'binary-expr',locations:[{start:{line:127,column:30},end:{line:127,column:44}},{start:{line:127,column:48},end:{line:127,column:58}}],line:127},'18':{loc:{start:{line:135,column:2},end:{line:138,column:46}},type:'if',locations:[{start:{line:135,column:2},end:{line:138,column:46}},{start:{line:135,column:2},end:{line:138,column:46}}],line:135},'19':{loc:{start:{line:140,column:2},end:{line:143,column:46}},type:'if',locations:[{start:{line:140,column:2},end:{line:143,column:46}},{start:{line:140,column:2},end:{line:143,column:46}}],line:140},'20':{loc:{start:{line:142,column:7},end:{line:143,column:46}},type:'if',locations:[{start:{line:142,column:7},end:{line:143,column:46}},{start:{line:142,column:7},end:{line:143,column:46}}],line:142},'21':{loc:{start:{line:145,column:2},end:{line:149,column:3}},type:'if',locations:[{start:{line:145,column:2},end:{line:149,column:3}},{start:{line:145,column:2},end:{line:149,column:3}}],line:145},'22':{loc:{start:{line:147,column:4},end:{line:148,column:54}},type:'if',locations:[{start:{line:147,column:4},end:{line:148,column:54}},{start:{line:147,column:4},end:{line:148,column:54}}],line:147},'23':{loc:{start:{line:151,column:2},end:{line:159,column:3}},type:'if',locations:[{start:{line:151,column:2},end:{line:159,column:3}},{start:{line:151,column:2},end:{line:159,column:3}}],line:151},'24':{loc:{start:{line:152,column:4},end:{line:158,column:5}},type:'if',locations:[{start:{line:152,column:4},end:{line:158,column:5}},{start:{line:152,column:4},end:{line:158,column:5}}],line:152},'25':{loc:{start:{line:161,column:2},end:{line:163,column:3}},type:'if',locations:[{start:{line:161,column:2},end:{line:163,column:3}},{start:{line:161,column:2},end:{line:163,column:3}}],line:161},'26':{loc:{start:{line:165,column:2},end:{line:190,column:3}},type:'if',locations:[{start:{line:165,column:2},end:{line:190,column:3}},{start:{line:165,column:2},end:{line:190,column:3}}],line:165},'27':{loc:{start:{line:166,column:4},end:{line:167,column:33}},type:'if',locations:[{start:{line:166,column:4},end:{line:167,column:33}},{start:{line:166,column:4},end:{line:167,column:33}}],line:166},'28':{loc:{start:{line:169,column:4},end:{line:189,column:5}},type:'if',locations:[{start:{line:169,column:4},end:{line:189,column:5}},{start:{line:169,column:4},end:{line:189,column:5}}],line:169},'29':{loc:{start:{line:172,column:20},end:{line:172,column:43}},type:'cond-expr',locations:[{start:{line:172,column:30},end:{line:172,column:37}},{start:{line:172,column:40},end:{line:172,column:43}}],line:172},'30':{loc:{start:{line:174,column:27},end:{line:174,column:63}},type:'binary-expr',locations:[{start:{line:174,column:27},end:{line:174,column:41}},{start:{line:174,column:45},end:{line:174,column:63}}],line:174},'31':{loc:{start:{line:175,column:8},end:{line:179,column:9}},type:'if',locations:[{start:{line:175,column:8},end:{line:179,column:9}},{start:{line:175,column:8},end:{line:179,column:9}}],line:175},'32':{loc:{start:{line:184,column:6},end:{line:188,column:7}},type:'if',locations:[{start:{line:184,column:6},end:{line:188,column:7}},{start:{line:184,column:6},end:{line:188,column:7}}],line:184},'33':{loc:{start:{line:195,column:2},end:{line:198,column:3}},type:'if',locations:[{start:{line:195,column:2},end:{line:198,column:3}},{start:{line:195,column:2},end:{line:198,column:3}}],line:195},'34':{loc:{start:{line:204,column:2},end:{line:205,column:16}},type:'if',locations:[{start:{line:204,column:2},end:{line:205,column:16}},{start:{line:204,column:2},end:{line:205,column:16}}],line:204},'35':{loc:{start:{line:207,column:2},end:{line:207,column:61}},type:'if',locations:[{start:{line:207,column:2},end:{line:207,column:61}},{start:{line:207,column:2},end:{line:207,column:61}}],line:207},'36':{loc:{start:{line:208,column:2},end:{line:210,column:3}},type:'if',locations:[{start:{line:208,column:2},end:{line:210,column:3}},{start:{line:208,column:2},end:{line:210,column:3}}],line:208},'37':{loc:{start:{line:208,column:6},end:{line:208,column:62}},type:'binary-expr',locations:[{start:{line:208,column:6},end:{line:208,column:33}},{start:{line:208,column:37},end:{line:208,column:62}}],line:208},'38':{loc:{start:{line:211,column:2},end:{line:211,column:64}},type:'if',locations:[{start:{line:211,column:2},end:{line:211,column:64}},{start:{line:211,column:2},end:{line:211,column:64}}],line:211},'39':{loc:{start:{line:212,column:2},end:{line:223,column:3}},type:'if',locations:[{start:{line:212,column:2},end:{line:223,column:3}},{start:{line:212,column:2},end:{line:223,column:3}}],line:212},'40':{loc:{start:{line:218,column:6},end:{line:221,column:34}},type:'if',locations:[{start:{line:218,column:6},end:{line:221,column:34}},{start:{line:218,column:6},end:{line:221,column:34}}],line:218}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0],'19':[0,0],'20':[0,0],'21':[0,0],'22':[0,0],'23':[0,0],'24':[0,0],'25':[0,0],'26':[0,0],'27':[0,0],'28':[0,0],'29':[0,0],'30':[0,0],'31':[0,0],'32':[0,0],'33':[0,0],'34':[0,0],'35':[0,0],'36':[0,0],'37':[0,0],'38':[0,0],'39':[0,0],'40':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const{parseCertString}=(cov_2h7cgo1yjz.s[0]++,require('internal/tls'));const{isArrayBufferView}=(cov_2h7cgo1yjz.s[1]++,require('internal/util/types'));const tls=(cov_2h7cgo1yjz.s[2]++,require('tls'));const errors=(cov_2h7cgo1yjz.s[3]++,require('internal/errors'));const SSL_OP_CIPHER_SERVER_PREFERENCE=(cov_2h7cgo1yjz.s[4]++,process.binding('constants').crypto.SSL_OP_CIPHER_SERVER_PREFERENCE);// Lazily loaded
var crypto=(cov_2h7cgo1yjz.s[5]++,null);const binding=(cov_2h7cgo1yjz.s[6]++,process.binding('crypto'));const NativeSecureContext=(cov_2h7cgo1yjz.s[7]++,binding.SecureContext);function SecureContext(secureProtocol,secureOptions,context){cov_2h7cgo1yjz.f[0]++;cov_2h7cgo1yjz.s[8]++;if(!(this instanceof SecureContext)){cov_2h7cgo1yjz.b[0][0]++;cov_2h7cgo1yjz.s[9]++;return new SecureContext(secureProtocol,secureOptions,context);}else{cov_2h7cgo1yjz.b[0][1]++;}cov_2h7cgo1yjz.s[10]++;if(context){cov_2h7cgo1yjz.b[1][0]++;cov_2h7cgo1yjz.s[11]++;this.context=context;}else{cov_2h7cgo1yjz.b[1][1]++;cov_2h7cgo1yjz.s[12]++;this.context=new NativeSecureContext();cov_2h7cgo1yjz.s[13]++;if(secureProtocol){cov_2h7cgo1yjz.b[2][0]++;cov_2h7cgo1yjz.s[14]++;this.context.init(secureProtocol);}else{cov_2h7cgo1yjz.b[2][1]++;cov_2h7cgo1yjz.s[15]++;this.context.init();}}cov_2h7cgo1yjz.s[16]++;if(secureOptions){cov_2h7cgo1yjz.b[3][0]++;cov_2h7cgo1yjz.s[17]++;this.context.setOptions(secureOptions);}else{cov_2h7cgo1yjz.b[3][1]++;}}function validateKeyCert(value,type){cov_2h7cgo1yjz.f[1]++;cov_2h7cgo1yjz.s[18]++;if((cov_2h7cgo1yjz.b[5][0]++,typeof value!=='string')&&(cov_2h7cgo1yjz.b[5][1]++,!isArrayBufferView(value))){cov_2h7cgo1yjz.b[4][0]++;cov_2h7cgo1yjz.s[19]++;throw new errors.TypeError('ERR_INVALID_ARG_TYPE',type,['string','Buffer','TypedArray','DataView']);}else{cov_2h7cgo1yjz.b[4][1]++;}}cov_2h7cgo1yjz.s[20]++;exports.SecureContext=SecureContext;cov_2h7cgo1yjz.s[21]++;exports.createSecureContext=function createSecureContext(options,context){cov_2h7cgo1yjz.f[2]++;cov_2h7cgo1yjz.s[22]++;if(!options){cov_2h7cgo1yjz.b[6][0]++;cov_2h7cgo1yjz.s[23]++;options={};}else{cov_2h7cgo1yjz.b[6][1]++;}var secureOptions=(cov_2h7cgo1yjz.s[24]++,options.secureOptions);cov_2h7cgo1yjz.s[25]++;if(options.honorCipherOrder){cov_2h7cgo1yjz.b[7][0]++;cov_2h7cgo1yjz.s[26]++;secureOptions|=SSL_OP_CIPHER_SERVER_PREFERENCE;}else{cov_2h7cgo1yjz.b[7][1]++;}var c=(cov_2h7cgo1yjz.s[27]++,new SecureContext(options.secureProtocol,secureOptions,context));var i;var val;cov_2h7cgo1yjz.s[28]++;if(context){cov_2h7cgo1yjz.b[8][0]++;cov_2h7cgo1yjz.s[29]++;return c;}else{cov_2h7cgo1yjz.b[8][1]++;}// NOTE: It's important to add CA before the cert to be able to load
// cert's issuer in C++ code.
var ca=(cov_2h7cgo1yjz.s[30]++,options.ca);cov_2h7cgo1yjz.s[31]++;if(ca){cov_2h7cgo1yjz.b[9][0]++;cov_2h7cgo1yjz.s[32]++;if(Array.isArray(ca)){cov_2h7cgo1yjz.b[10][0]++;cov_2h7cgo1yjz.s[33]++;for(i=0;i<ca.length;++i){cov_2h7cgo1yjz.s[34]++;val=ca[i];cov_2h7cgo1yjz.s[35]++;validateKeyCert(val,'ca');cov_2h7cgo1yjz.s[36]++;c.context.addCACert(val);}}else{cov_2h7cgo1yjz.b[10][1]++;cov_2h7cgo1yjz.s[37]++;validateKeyCert(ca,'ca');cov_2h7cgo1yjz.s[38]++;c.context.addCACert(ca);}}else{cov_2h7cgo1yjz.b[9][1]++;cov_2h7cgo1yjz.s[39]++;c.context.addRootCerts();}var cert=(cov_2h7cgo1yjz.s[40]++,options.cert);cov_2h7cgo1yjz.s[41]++;if(cert){cov_2h7cgo1yjz.b[11][0]++;cov_2h7cgo1yjz.s[42]++;if(Array.isArray(cert)){cov_2h7cgo1yjz.b[12][0]++;cov_2h7cgo1yjz.s[43]++;for(i=0;i<cert.length;++i){cov_2h7cgo1yjz.s[44]++;val=cert[i];cov_2h7cgo1yjz.s[45]++;validateKeyCert(val,'cert');cov_2h7cgo1yjz.s[46]++;c.context.setCert(val);}}else{cov_2h7cgo1yjz.b[12][1]++;cov_2h7cgo1yjz.s[47]++;validateKeyCert(cert,'cert');cov_2h7cgo1yjz.s[48]++;c.context.setCert(cert);}}else{cov_2h7cgo1yjz.b[11][1]++;}// NOTE: It is important to set the key after the cert.
// `ssl_set_pkey` returns `0` when the key does not match the cert, but
// `ssl_set_cert` returns `1` and nullifies the key in the SSL structure
// which leads to the crash later on.
var key=(cov_2h7cgo1yjz.s[49]++,options.key);var passphrase=(cov_2h7cgo1yjz.s[50]++,options.passphrase);cov_2h7cgo1yjz.s[51]++;if(key){cov_2h7cgo1yjz.b[13][0]++;cov_2h7cgo1yjz.s[52]++;if(Array.isArray(key)){cov_2h7cgo1yjz.b[14][0]++;cov_2h7cgo1yjz.s[53]++;for(i=0;i<key.length;++i){cov_2h7cgo1yjz.s[54]++;val=key[i];// eslint-disable-next-line eqeqeq
const pem=(cov_2h7cgo1yjz.s[55]++,(cov_2h7cgo1yjz.b[16][0]++,val!=undefined)&&(cov_2h7cgo1yjz.b[16][1]++,val.pem!==undefined)?(cov_2h7cgo1yjz.b[15][0]++,val.pem):(cov_2h7cgo1yjz.b[15][1]++,val));cov_2h7cgo1yjz.s[56]++;validateKeyCert(pem,'key');cov_2h7cgo1yjz.s[57]++;c.context.setKey(pem,(cov_2h7cgo1yjz.b[17][0]++,val.passphrase)||(cov_2h7cgo1yjz.b[17][1]++,passphrase));}}else{cov_2h7cgo1yjz.b[14][1]++;cov_2h7cgo1yjz.s[58]++;validateKeyCert(key,'key');cov_2h7cgo1yjz.s[59]++;c.context.setKey(key,passphrase);}}else{cov_2h7cgo1yjz.b[13][1]++;}cov_2h7cgo1yjz.s[60]++;if(options.ciphers){cov_2h7cgo1yjz.b[18][0]++;cov_2h7cgo1yjz.s[61]++;c.context.setCiphers(options.ciphers);}else{cov_2h7cgo1yjz.b[18][1]++;cov_2h7cgo1yjz.s[62]++;c.context.setCiphers(tls.DEFAULT_CIPHERS);}cov_2h7cgo1yjz.s[63]++;if(options.ecdhCurve===undefined){cov_2h7cgo1yjz.b[19][0]++;cov_2h7cgo1yjz.s[64]++;c.context.setECDHCurve(tls.DEFAULT_ECDH_CURVE);}else{cov_2h7cgo1yjz.b[19][1]++;cov_2h7cgo1yjz.s[65]++;if(options.ecdhCurve){cov_2h7cgo1yjz.b[20][0]++;cov_2h7cgo1yjz.s[66]++;c.context.setECDHCurve(options.ecdhCurve);}else{cov_2h7cgo1yjz.b[20][1]++;}}cov_2h7cgo1yjz.s[67]++;if(options.dhparam){cov_2h7cgo1yjz.b[21][0]++;const warning=(cov_2h7cgo1yjz.s[68]++,c.context.setDHParam(options.dhparam));cov_2h7cgo1yjz.s[69]++;if(warning){cov_2h7cgo1yjz.b[22][0]++;cov_2h7cgo1yjz.s[70]++;process.emitWarning(warning,'SecurityWarning');}else{cov_2h7cgo1yjz.b[22][1]++;}}else{cov_2h7cgo1yjz.b[21][1]++;}cov_2h7cgo1yjz.s[71]++;if(options.crl){cov_2h7cgo1yjz.b[23][0]++;cov_2h7cgo1yjz.s[72]++;if(Array.isArray(options.crl)){cov_2h7cgo1yjz.b[24][0]++;cov_2h7cgo1yjz.s[73]++;for(i=0;i<options.crl.length;i++){cov_2h7cgo1yjz.s[74]++;c.context.addCRL(options.crl[i]);}}else{cov_2h7cgo1yjz.b[24][1]++;cov_2h7cgo1yjz.s[75]++;c.context.addCRL(options.crl);}}else{cov_2h7cgo1yjz.b[23][1]++;}cov_2h7cgo1yjz.s[76]++;if(options.sessionIdContext){cov_2h7cgo1yjz.b[25][0]++;cov_2h7cgo1yjz.s[77]++;c.context.setSessionIdContext(options.sessionIdContext);}else{cov_2h7cgo1yjz.b[25][1]++;}cov_2h7cgo1yjz.s[78]++;if(options.pfx){cov_2h7cgo1yjz.b[26][0]++;cov_2h7cgo1yjz.s[79]++;if(!crypto){cov_2h7cgo1yjz.b[27][0]++;cov_2h7cgo1yjz.s[80]++;crypto=require('crypto');}else{cov_2h7cgo1yjz.b[27][1]++;}cov_2h7cgo1yjz.s[81]++;if(Array.isArray(options.pfx)){cov_2h7cgo1yjz.b[28][0]++;cov_2h7cgo1yjz.s[82]++;for(i=0;i<options.pfx.length;i++){const pfx=(cov_2h7cgo1yjz.s[83]++,options.pfx[i]);const raw=(cov_2h7cgo1yjz.s[84]++,pfx.buf?(cov_2h7cgo1yjz.b[29][0]++,pfx.buf):(cov_2h7cgo1yjz.b[29][1]++,pfx));const buf=(cov_2h7cgo1yjz.s[85]++,crypto._toBuf(raw));const passphrase=(cov_2h7cgo1yjz.s[86]++,(cov_2h7cgo1yjz.b[30][0]++,pfx.passphrase)||(cov_2h7cgo1yjz.b[30][1]++,options.passphrase));cov_2h7cgo1yjz.s[87]++;if(passphrase){cov_2h7cgo1yjz.b[31][0]++;cov_2h7cgo1yjz.s[88]++;c.context.loadPKCS12(buf,crypto._toBuf(passphrase));}else{cov_2h7cgo1yjz.b[31][1]++;cov_2h7cgo1yjz.s[89]++;c.context.loadPKCS12(buf);}}}else{cov_2h7cgo1yjz.b[28][1]++;const buf=(cov_2h7cgo1yjz.s[90]++,crypto._toBuf(options.pfx));const passphrase=(cov_2h7cgo1yjz.s[91]++,options.passphrase);cov_2h7cgo1yjz.s[92]++;if(passphrase){cov_2h7cgo1yjz.b[32][0]++;cov_2h7cgo1yjz.s[93]++;c.context.loadPKCS12(buf,crypto._toBuf(passphrase));}else{cov_2h7cgo1yjz.b[32][1]++;cov_2h7cgo1yjz.s[94]++;c.context.loadPKCS12(buf);}}}else{cov_2h7cgo1yjz.b[26][1]++;}// Do not keep read/write buffers in free list for OpenSSL < 1.1.0. (For
// OpenSSL 1.1.0, buffers are malloced and freed without the use of a
// freelist.)
cov_2h7cgo1yjz.s[95]++;if(options.singleUse){cov_2h7cgo1yjz.b[33][0]++;cov_2h7cgo1yjz.s[96]++;c.singleUse=true;cov_2h7cgo1yjz.s[97]++;c.context.setFreeListLength(0);}else{cov_2h7cgo1yjz.b[33][1]++;}cov_2h7cgo1yjz.s[98]++;return c;};cov_2h7cgo1yjz.s[99]++;exports.translatePeerCertificate=function translatePeerCertificate(c){cov_2h7cgo1yjz.f[3]++;cov_2h7cgo1yjz.s[100]++;if(!c){cov_2h7cgo1yjz.b[34][0]++;cov_2h7cgo1yjz.s[101]++;return null;}else{cov_2h7cgo1yjz.b[34][1]++;}cov_2h7cgo1yjz.s[102]++;if(c.issuer!=null){cov_2h7cgo1yjz.b[35][0]++;cov_2h7cgo1yjz.s[103]++;c.issuer=parseCertString(c.issuer);}else{cov_2h7cgo1yjz.b[35][1]++;}cov_2h7cgo1yjz.s[104]++;if((cov_2h7cgo1yjz.b[37][0]++,c.issuerCertificate!=null)&&(cov_2h7cgo1yjz.b[37][1]++,c.issuerCertificate!==c)){cov_2h7cgo1yjz.b[36][0]++;cov_2h7cgo1yjz.s[105]++;c.issuerCertificate=translatePeerCertificate(c.issuerCertificate);}else{cov_2h7cgo1yjz.b[36][1]++;}cov_2h7cgo1yjz.s[106]++;if(c.subject!=null){cov_2h7cgo1yjz.b[38][0]++;cov_2h7cgo1yjz.s[107]++;c.subject=parseCertString(c.subject);}else{cov_2h7cgo1yjz.b[38][1]++;}cov_2h7cgo1yjz.s[108]++;if(c.infoAccess!=null){cov_2h7cgo1yjz.b[39][0]++;var info=(cov_2h7cgo1yjz.s[109]++,c.infoAccess);cov_2h7cgo1yjz.s[110]++;c.infoAccess=Object.create(null);// XXX: More key validation?
cov_2h7cgo1yjz.s[111]++;info.replace(/([^\n:]*):([^\n]*)(?:\n|$)/g,function(all,key,val){cov_2h7cgo1yjz.f[4]++;cov_2h7cgo1yjz.s[112]++;if(key in c.infoAccess){cov_2h7cgo1yjz.b[40][0]++;cov_2h7cgo1yjz.s[113]++;c.infoAccess[key].push(val);}else{cov_2h7cgo1yjz.b[40][1]++;cov_2h7cgo1yjz.s[114]++;c.infoAccess[key]=[val];}});}else{cov_2h7cgo1yjz.b[39][1]++;}cov_2h7cgo1yjz.s[115]++;return c;};