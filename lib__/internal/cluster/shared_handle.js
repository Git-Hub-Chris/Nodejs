'use strict';var cov_2n5ixngyh=function(){var path='internal/cluster/shared_handle.js',hash='a12a2d12dca38de0287c89964a419df3cd59b795',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'internal/cluster/shared_handle.js',statementMap:{'0':{start:{line:2,column:15},end:{line:2,column:32}},'1':{start:{line:3,column:14},end:{line:3,column:30}},'2':{start:{line:4,column:12},end:{line:4,column:26}},'3':{start:{line:6,column:0},end:{line:6,column:30}},'4':{start:{line:9,column:2},end:{line:9,column:17}},'5':{start:{line:10,column:2},end:{line:10,column:20}},'6':{start:{line:11,column:2},end:{line:11,column:21}},'7':{start:{line:12,column:2},end:{line:12,column:17}},'8':{start:{line:15,column:2},end:{line:18,column:67}},'9':{start:{line:16,column:4},end:{line:16,column:76}},'10':{start:{line:18,column:4},end:{line:18,column:67}},'11':{start:{line:20,column:2},end:{line:23,column:23}},'12':{start:{line:21,column:4},end:{line:21,column:22}},'13':{start:{line:23,column:4},end:{line:23,column:23}},'14':{start:{line:26,column:0},end:{line:30,column:2}},'15':{start:{line:27,column:2},end:{line:27,column:46}},'16':{start:{line:28,column:2},end:{line:28,column:28}},'17':{start:{line:29,column:2},end:{line:29,column:38}},'18':{start:{line:32,column:0},end:{line:46,column:2}},'19':{start:{line:33,column:16},end:{line:33,column:44}},'20':{start:{line:35,column:2},end:{line:36,column:17}},'21':{start:{line:36,column:4},end:{line:36,column:17}},'22':{start:{line:38,column:2},end:{line:38,column:32}},'23':{start:{line:40,column:2},end:{line:41,column:17}},'24':{start:{line:41,column:4},end:{line:41,column:17}},'25':{start:{line:43,column:2},end:{line:43,column:22}},'26':{start:{line:44,column:2},end:{line:44,column:21}},'27':{start:{line:45,column:2},end:{line:45,column:14}}},fnMap:{'0':{name:'SharedHandle',decl:{start:{line:8,column:9},end:{line:8,column:21}},loc:{start:{line:8,column:66},end:{line:24,column:1}},line:8},'1':{name:'(anonymous_1)',decl:{start:{line:26,column:29},end:{line:26,column:30}},loc:{start:{line:26,column:52},end:{line:30,column:1}},line:26},'2':{name:'(anonymous_2)',decl:{start:{line:32,column:32},end:{line:32,column:33}},loc:{start:{line:32,column:49},end:{line:46,column:1}},line:32}},branchMap:{'0':{loc:{start:{line:15,column:2},end:{line:18,column:67}},type:'if',locations:[{start:{line:15,column:2},end:{line:18,column:67}},{start:{line:15,column:2},end:{line:18,column:67}}],line:15},'1':{loc:{start:{line:15,column:6},end:{line:15,column:54}},type:'binary-expr',locations:[{start:{line:15,column:6},end:{line:15,column:28}},{start:{line:15,column:32},end:{line:15,column:54}}],line:15},'2':{loc:{start:{line:20,column:2},end:{line:23,column:23}},type:'if',locations:[{start:{line:20,column:2},end:{line:23,column:23}},{start:{line:20,column:2},end:{line:23,column:23}}],line:20},'3':{loc:{start:{line:35,column:2},end:{line:36,column:17}},type:'if',locations:[{start:{line:35,column:2},end:{line:36,column:17}},{start:{line:35,column:2},end:{line:36,column:17}}],line:35},'4':{loc:{start:{line:40,column:2},end:{line:41,column:17}},type:'if',locations:[{start:{line:40,column:2},end:{line:41,column:17}},{start:{line:40,column:2},end:{line:41,column:17}}],line:40}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0},f:{'0':0,'1':0,'2':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const assert=(cov_2n5ixngyh.s[0]++,require('assert'));const dgram=(cov_2n5ixngyh.s[1]++,require('dgram'));const net=(cov_2n5ixngyh.s[2]++,require('net'));cov_2n5ixngyh.s[3]++;module.exports=SharedHandle;function SharedHandle(key,address,port,addressType,fd,flags){cov_2n5ixngyh.f[0]++;cov_2n5ixngyh.s[4]++;this.key=key;cov_2n5ixngyh.s[5]++;this.workers=[];cov_2n5ixngyh.s[6]++;this.handle=null;cov_2n5ixngyh.s[7]++;this.errno=0;var rval;cov_2n5ixngyh.s[8]++;if((cov_2n5ixngyh.b[1][0]++,addressType==='udp4')||(cov_2n5ixngyh.b[1][1]++,addressType==='udp6')){cov_2n5ixngyh.b[0][0]++;cov_2n5ixngyh.s[9]++;rval=dgram._createSocketHandle(address,port,addressType,fd,flags);}else{cov_2n5ixngyh.b[0][1]++;cov_2n5ixngyh.s[10]++;rval=net._createServerHandle(address,port,addressType,fd);}cov_2n5ixngyh.s[11]++;if(typeof rval==='number'){cov_2n5ixngyh.b[2][0]++;cov_2n5ixngyh.s[12]++;this.errno=rval;}else{cov_2n5ixngyh.b[2][1]++;cov_2n5ixngyh.s[13]++;this.handle=rval;}}cov_2n5ixngyh.s[14]++;SharedHandle.prototype.add=function(worker,send){cov_2n5ixngyh.f[1]++;cov_2n5ixngyh.s[15]++;assert(this.workers.indexOf(worker)===-1);cov_2n5ixngyh.s[16]++;this.workers.push(worker);cov_2n5ixngyh.s[17]++;send(this.errno,null,this.handle);};cov_2n5ixngyh.s[18]++;SharedHandle.prototype.remove=function(worker){cov_2n5ixngyh.f[2]++;const index=(cov_2n5ixngyh.s[19]++,this.workers.indexOf(worker));cov_2n5ixngyh.s[20]++;if(index===-1){cov_2n5ixngyh.b[3][0]++;cov_2n5ixngyh.s[21]++;return false;}else{cov_2n5ixngyh.b[3][1]++;}// The worker wasn't sharing this handle.
cov_2n5ixngyh.s[22]++;this.workers.splice(index,1);cov_2n5ixngyh.s[23]++;if(this.workers.length!==0){cov_2n5ixngyh.b[4][0]++;cov_2n5ixngyh.s[24]++;return false;}else{cov_2n5ixngyh.b[4][1]++;}cov_2n5ixngyh.s[25]++;this.handle.close();cov_2n5ixngyh.s[26]++;this.handle=null;cov_2n5ixngyh.s[27]++;return true;};