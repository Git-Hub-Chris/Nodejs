// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
'use strict';var cov_1cqvgzuehr=function(){var path='tls.js',hash='636ee7d8dc190039fe51fe5ac4d1a9a21e0e5281',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'tls.js',statementMap:{'0':{start:{line:24,column:15},end:{line:24,column:41}},'1':{start:{line:25,column:21},end:{line:25,column:45}},'2':{start:{line:26,column:20},end:{line:26,column:43}},'3':{start:{line:27,column:0},end:{line:27,column:28}},'4':{start:{line:28,column:25},end:{line:28,column:55}},'5':{start:{line:30,column:12},end:{line:30,column:26}},'6':{start:{line:31,column:12},end:{line:31,column:26}},'7':{start:{line:32,column:16},end:{line:32,column:41}},'8':{start:{line:33,column:15},end:{line:33,column:39}},'9':{start:{line:39,column:0},end:{line:39,column:31}},'10':{start:{line:40,column:0},end:{line:40,column:34}},'11':{start:{line:42,column:0},end:{line:42,column:44}},'12':{start:{line:44,column:0},end:{line:45,column:58}},'13':{start:{line:47,column:0},end:{line:47,column:42}},'14':{start:{line:49,column:0},end:{line:51,column:2}},'15':{start:{line:50,column:8},end:{line:50,column:74}},'16':{start:{line:56,column:15},end:{line:56,column:42}},'17':{start:{line:57,column:15},end:{line:61,column:8}},'18':{start:{line:58,column:14},end:{line:58,column:34}},'19':{start:{line:59,column:4},end:{line:59,column:18}},'20':{start:{line:60,column:4},end:{line:60,column:23}},'21':{start:{line:63,column:15},end:{line:63,column:16}},'22':{start:{line:64,column:2},end:{line:68,column:3}},'23':{start:{line:65,column:4},end:{line:65,column:29}},'24':{start:{line:66,column:4},end:{line:66,column:37}},'25':{start:{line:67,column:4},end:{line:67,column:22}},'26':{start:{line:70,column:2},end:{line:70,column:14}},'27':{start:{line:73,column:0},end:{line:81,column:2}},'28':{start:{line:75,column:2},end:{line:80,column:3}},'29':{start:{line:76,column:4},end:{line:76,column:51}},'30':{start:{line:77,column:9},end:{line:80,column:3}},'31':{start:{line:79,column:4},end:{line:79,column:46}},'32':{start:{line:83,column:0},end:{line:91,column:2}},'33':{start:{line:85,column:2},end:{line:90,column:3}},'34':{start:{line:86,column:4},end:{line:86,column:52}},'35':{start:{line:87,column:9},end:{line:90,column:3}},'36':{start:{line:89,column:4},end:{line:89,column:47}},'37':{start:{line:94,column:2},end:{line:94,column:34}},'38':{start:{line:100,column:19},end:{line:100,column:67}},'39':{start:{line:100,column:26},end:{line:100,column:67}},'40':{start:{line:101,column:2},end:{line:101,column:61}},'41':{start:{line:106,column:2},end:{line:107,column:17}},'42':{start:{line:107,column:4},end:{line:107,column:17}},'43':{start:{line:109,column:23},end:{line:109,column:41}},'44':{start:{line:111,column:2},end:{line:112,column:17}},'45':{start:{line:112,column:4},end:{line:112,column:17}},'46':{start:{line:115,column:2},end:{line:116,column:17}},'47':{start:{line:116,column:4},end:{line:116,column:17}},'48':{start:{line:122,column:16},end:{line:122,column:50}},'49':{start:{line:122,column:23},end:{line:122,column:50}},'50':{start:{line:123,column:2},end:{line:124,column:17}},'51':{start:{line:124,column:4},end:{line:124,column:17}},'52':{start:{line:127,column:2},end:{line:130,column:3}},'53':{start:{line:128,column:4},end:{line:129,column:19}},'54':{start:{line:129,column:6},end:{line:129,column:19}},'55':{start:{line:132,column:24},end:{line:132,column:36}},'56':{start:{line:133,column:27},end:{line:133,column:42}},'57':{start:{line:134,column:32},end:{line:134,column:59}},'58':{start:{line:139,column:2},end:{line:140,column:46}},'59':{start:{line:140,column:4},end:{line:140,column:46}},'60':{start:{line:142,column:2},end:{line:143,column:17}},'61':{start:{line:143,column:4},end:{line:143,column:17}},'62':{start:{line:146,column:2},end:{line:147,column:17}},'63':{start:{line:147,column:4},end:{line:147,column:17}},'64':{start:{line:150,column:2},end:{line:151,column:17}},'65':{start:{line:151,column:4},end:{line:151,column:17}},'66':{start:{line:153,column:27},end:{line:153,column:48}},'67':{start:{line:155,column:2},end:{line:156,column:17}},'68':{start:{line:156,column:4},end:{line:156,column:17}},'69':{start:{line:158,column:2},end:{line:159,column:17}},'70':{start:{line:159,column:4},end:{line:159,column:17}},'71':{start:{line:161,column:2},end:{line:162,column:17}},'72':{start:{line:162,column:4},end:{line:162,column:17}},'73':{start:{line:164,column:2},end:{line:164,column:14}},'74':{start:{line:167,column:0},end:{line:230,column:2}},'75':{start:{line:168,column:18},end:{line:168,column:30}},'76':{start:{line:169,column:19},end:{line:169,column:38}},'77':{start:{line:170,column:19},end:{line:170,column:21}},'78':{start:{line:171,column:19},end:{line:171,column:21}},'79':{start:{line:172,column:14},end:{line:172,column:16}},'80':{start:{line:174,column:2},end:{line:174,column:19}},'81':{start:{line:176,column:2},end:{line:187,column:3}},'82':{start:{line:177,column:4},end:{line:186,column:5}},'83':{start:{line:178,column:6},end:{line:185,column:7}},'84':{start:{line:179,column:8},end:{line:179,column:37}},'85':{start:{line:180,column:13},end:{line:185,column:7}},'86':{start:{line:181,column:20},end:{line:181,column:44}},'87':{start:{line:182,column:8},end:{line:182,column:36}},'88':{start:{line:183,column:13},end:{line:185,column:7}},'89':{start:{line:184,column:8},end:{line:184,column:33}},'90':{start:{line:189,column:14},end:{line:189,column:19}},'91':{start:{line:190,column:15},end:{line:190,column:31}},'92':{start:{line:192,column:2},end:{line:221,column:3}},'93':{start:{line:193,column:4},end:{line:193,column:31}},'94':{start:{line:194,column:4},end:{line:195,column:74}},'95':{start:{line:195,column:6},end:{line:195,column:74}},'96':{start:{line:197,column:9},end:{line:221,column:3}},'97':{start:{line:198,column:4},end:{line:198,column:24}},'98':{start:{line:199,column:22},end:{line:199,column:37}},'99':{start:{line:200,column:21},end:{line:200,column:65}},'100':{start:{line:200,column:34},end:{line:200,column:65}},'101':{start:{line:201,column:23},end:{line:201,column:68}},'102':{start:{line:201,column:36},end:{line:201,column:68}},'103':{start:{line:204,column:4},end:{line:218,column:5}},'104':{start:{line:205,column:17},end:{line:205,column:27}},'105':{start:{line:207,column:6},end:{line:210,column:29}},'106':{start:{line:208,column:8},end:{line:208,column:34}},'107':{start:{line:209,column:11},end:{line:210,column:29}},'108':{start:{line:210,column:8},end:{line:210,column:29}},'109':{start:{line:212,column:6},end:{line:213,column:58}},'110':{start:{line:213,column:8},end:{line:213,column:58}},'111':{start:{line:215,column:6},end:{line:215,column:67}},'112':{start:{line:216,column:6},end:{line:217,column:77}},'113':{start:{line:217,column:8},end:{line:217,column:77}},'114':{start:{line:220,column:4},end:{line:220,column:29}},'115':{start:{line:223,column:2},end:{line:229,column:3}},'116':{start:{line:224,column:16},end:{line:224,column:72}},'117':{start:{line:225,column:4},end:{line:225,column:24}},'118':{start:{line:226,column:4},end:{line:226,column:20}},'119':{start:{line:227,column:4},end:{line:227,column:20}},'120':{start:{line:228,column:4},end:{line:228,column:15}},'121':{start:{line:232,column:0},end:{line:236,column:13}},'122':{start:{line:239,column:0},end:{line:239,column:73}},'123':{start:{line:240,column:0},end:{line:240,column:61}},'124':{start:{line:241,column:0},end:{line:241,column:51}},'125':{start:{line:242,column:0},end:{line:242,column:45}},'126':{start:{line:243,column:0},end:{line:243,column:57}},'127':{start:{line:244,column:0},end:{line:244,column:47}},'128':{start:{line:247,column:0},end:{line:247,column:67}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:50,column:2},end:{line:50,column:3}},loc:{start:{line:50,column:8},end:{line:50,column:74}},line:50},'1':{name:'convertProtocols',decl:{start:{line:55,column:9},end:{line:55,column:25}},loc:{start:{line:55,column:37},end:{line:71,column:1}},line:55},'2':{name:'(anonymous_2)',decl:{start:{line:57,column:51},end:{line:57,column:52}},loc:{start:{line:57,column:64},end:{line:61,column:3}},line:57},'3':{name:'(anonymous_3)',decl:{start:{line:73,column:30},end:{line:73,column:31}},loc:{start:{line:73,column:55},end:{line:81,column:1}},line:73},'4':{name:'(anonymous_4)',decl:{start:{line:83,column:31},end:{line:83,column:32}},loc:{start:{line:83,column:56},end:{line:91,column:1}},line:83},'5':{name:'unfqdn',decl:{start:{line:93,column:9},end:{line:93,column:15}},loc:{start:{line:93,column:22},end:{line:95,column:1}},line:93},'6':{name:'splitHost',decl:{start:{line:97,column:9},end:{line:97,column:18}},loc:{start:{line:97,column:25},end:{line:102,column:1}},line:97},'7':{name:'(anonymous_7)',decl:{start:{line:100,column:19},end:{line:100,column:20}},loc:{start:{line:100,column:26},end:{line:100,column:67}},line:100},'8':{name:'check',decl:{start:{line:104,column:9},end:{line:104,column:14}},loc:{start:{line:104,column:46},end:{line:165,column:1}},line:104},'9':{name:'(anonymous_9)',decl:{start:{line:122,column:16},end:{line:122,column:17}},loc:{start:{line:122,column:23},end:{line:122,column:50}},line:122},'10':{name:'checkServerIdentity',decl:{start:{line:167,column:39},end:{line:167,column:58}},loc:{start:{line:167,column:71},end:{line:230,column:1}},line:167},'11':{name:'(anonymous_11)',decl:{start:{line:200,column:21},end:{line:200,column:22}},loc:{start:{line:200,column:34},end:{line:200,column:65}},line:200},'12':{name:'(anonymous_12)',decl:{start:{line:201,column:23},end:{line:201,column:24}},loc:{start:{line:201,column:36},end:{line:201,column:68}},line:201}},branchMap:{'0':{loc:{start:{line:75,column:2},end:{line:80,column:3}},type:'if',locations:[{start:{line:75,column:2},end:{line:80,column:3}},{start:{line:75,column:2},end:{line:80,column:3}}],line:75},'1':{loc:{start:{line:77,column:9},end:{line:80,column:3}},type:'if',locations:[{start:{line:77,column:9},end:{line:80,column:3}},{start:{line:77,column:9},end:{line:80,column:3}}],line:77},'2':{loc:{start:{line:85,column:2},end:{line:90,column:3}},type:'if',locations:[{start:{line:85,column:2},end:{line:90,column:3}},{start:{line:85,column:2},end:{line:90,column:3}}],line:85},'3':{loc:{start:{line:87,column:9},end:{line:90,column:3}},type:'if',locations:[{start:{line:87,column:9},end:{line:90,column:3}},{start:{line:87,column:9},end:{line:90,column:3}}],line:87},'4':{loc:{start:{line:106,column:2},end:{line:107,column:17}},type:'if',locations:[{start:{line:106,column:2},end:{line:107,column:17}},{start:{line:106,column:2},end:{line:107,column:17}}],line:106},'5':{loc:{start:{line:111,column:2},end:{line:112,column:17}},type:'if',locations:[{start:{line:111,column:2},end:{line:112,column:17}},{start:{line:111,column:2},end:{line:112,column:17}}],line:111},'6':{loc:{start:{line:115,column:2},end:{line:116,column:17}},type:'if',locations:[{start:{line:115,column:2},end:{line:116,column:17}},{start:{line:115,column:2},end:{line:116,column:17}}],line:115},'7':{loc:{start:{line:123,column:2},end:{line:124,column:17}},type:'if',locations:[{start:{line:123,column:2},end:{line:124,column:17}},{start:{line:123,column:2},end:{line:124,column:17}}],line:123},'8':{loc:{start:{line:128,column:4},end:{line:129,column:19}},type:'if',locations:[{start:{line:128,column:4},end:{line:129,column:19}},{start:{line:128,column:4},end:{line:129,column:19}}],line:128},'9':{loc:{start:{line:139,column:2},end:{line:140,column:46}},type:'if',locations:[{start:{line:139,column:2},end:{line:140,column:46}},{start:{line:139,column:2},end:{line:140,column:46}}],line:139},'10':{loc:{start:{line:139,column:6},end:{line:139,column:77}},type:'binary-expr',locations:[{start:{line:139,column:6},end:{line:139,column:40}},{start:{line:139,column:44},end:{line:139,column:77}}],line:139},'11':{loc:{start:{line:142,column:2},end:{line:143,column:17}},type:'if',locations:[{start:{line:142,column:2},end:{line:143,column:17}},{start:{line:142,column:2},end:{line:143,column:17}}],line:142},'12':{loc:{start:{line:146,column:2},end:{line:147,column:17}},type:'if',locations:[{start:{line:146,column:2},end:{line:147,column:17}},{start:{line:146,column:2},end:{line:147,column:17}}],line:146},'13':{loc:{start:{line:150,column:2},end:{line:151,column:17}},type:'if',locations:[{start:{line:150,column:2},end:{line:151,column:17}},{start:{line:150,column:2},end:{line:151,column:17}}],line:150},'14':{loc:{start:{line:155,column:2},end:{line:156,column:17}},type:'if',locations:[{start:{line:155,column:2},end:{line:156,column:17}},{start:{line:155,column:2},end:{line:156,column:17}}],line:155},'15':{loc:{start:{line:158,column:2},end:{line:159,column:17}},type:'if',locations:[{start:{line:158,column:2},end:{line:159,column:17}},{start:{line:158,column:2},end:{line:159,column:17}}],line:158},'16':{loc:{start:{line:161,column:2},end:{line:162,column:17}},type:'if',locations:[{start:{line:161,column:2},end:{line:162,column:17}},{start:{line:161,column:2},end:{line:162,column:17}}],line:161},'17':{loc:{start:{line:176,column:2},end:{line:187,column:3}},type:'if',locations:[{start:{line:176,column:2},end:{line:187,column:3}},{start:{line:176,column:2},end:{line:187,column:3}}],line:176},'18':{loc:{start:{line:178,column:6},end:{line:185,column:7}},type:'if',locations:[{start:{line:178,column:6},end:{line:185,column:7}},{start:{line:178,column:6},end:{line:185,column:7}}],line:178},'19':{loc:{start:{line:180,column:13},end:{line:185,column:7}},type:'if',locations:[{start:{line:180,column:13},end:{line:185,column:7}},{start:{line:180,column:13},end:{line:185,column:7}}],line:180},'20':{loc:{start:{line:183,column:13},end:{line:185,column:7}},type:'if',locations:[{start:{line:183,column:13},end:{line:185,column:7}},{start:{line:183,column:13},end:{line:185,column:7}}],line:183},'21':{loc:{start:{line:192,column:2},end:{line:221,column:3}},type:'if',locations:[{start:{line:192,column:2},end:{line:221,column:3}},{start:{line:192,column:2},end:{line:221,column:3}}],line:192},'22':{loc:{start:{line:194,column:4},end:{line:195,column:74}},type:'if',locations:[{start:{line:194,column:4},end:{line:195,column:74}},{start:{line:194,column:4},end:{line:195,column:74}}],line:194},'23':{loc:{start:{line:197,column:9},end:{line:221,column:3}},type:'if',locations:[{start:{line:197,column:9},end:{line:221,column:3}},{start:{line:197,column:9},end:{line:221,column:3}}],line:197},'24':{loc:{start:{line:204,column:4},end:{line:218,column:5}},type:'if',locations:[{start:{line:204,column:4},end:{line:218,column:5}},{start:{line:204,column:4},end:{line:218,column:5}}],line:204},'25':{loc:{start:{line:204,column:8},end:{line:204,column:74}},type:'binary-expr',locations:[{start:{line:204,column:8},end:{line:204,column:29}},{start:{line:204,column:33},end:{line:204,column:49}},{start:{line:204,column:53},end:{line:204,column:74}}],line:204},'26':{loc:{start:{line:207,column:6},end:{line:210,column:29}},type:'if',locations:[{start:{line:207,column:6},end:{line:210,column:29}},{start:{line:207,column:6},end:{line:210,column:29}}],line:207},'27':{loc:{start:{line:209,column:11},end:{line:210,column:29}},type:'if',locations:[{start:{line:209,column:11},end:{line:210,column:29}},{start:{line:209,column:11},end:{line:210,column:29}}],line:209},'28':{loc:{start:{line:212,column:6},end:{line:213,column:58}},type:'if',locations:[{start:{line:212,column:6},end:{line:213,column:58}},{start:{line:212,column:6},end:{line:213,column:58}}],line:212},'29':{loc:{start:{line:215,column:14},end:{line:215,column:66}},type:'binary-expr',locations:[{start:{line:215,column:14},end:{line:215,column:37}},{start:{line:215,column:41},end:{line:215,column:66}}],line:215},'30':{loc:{start:{line:216,column:6},end:{line:217,column:77}},type:'if',locations:[{start:{line:216,column:6},end:{line:217,column:77}},{start:{line:216,column:6},end:{line:217,column:77}}],line:216},'31':{loc:{start:{line:223,column:2},end:{line:229,column:3}},type:'if',locations:[{start:{line:223,column:2},end:{line:229,column:3}},{start:{line:223,column:2},end:{line:229,column:3}}],line:223}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0,'116':0,'117':0,'118':0,'119':0,'120':0,'121':0,'122':0,'123':0,'124':0,'125':0,'126':0,'127':0,'128':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0],'19':[0,0],'20':[0,0],'21':[0,0],'22':[0,0],'23':[0,0],'24':[0,0],'25':[0,0,0],'26':[0,0],'27':[0,0],'28':[0,0],'29':[0,0],'30':[0,0],'31':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const errors=(cov_1cqvgzuehr.s[0]++,require('internal/errors'));const internalUtil=(cov_1cqvgzuehr.s[1]++,require('internal/util'));const internalTLS=(cov_1cqvgzuehr.s[2]++,require('internal/tls'));cov_1cqvgzuehr.s[3]++;internalUtil.assertCrypto();const{isUint8Array}=(cov_1cqvgzuehr.s[4]++,require('internal/util/types'));const net=(cov_1cqvgzuehr.s[5]++,require('net'));const url=(cov_1cqvgzuehr.s[6]++,require('url'));const binding=(cov_1cqvgzuehr.s[7]++,process.binding('crypto'));const Buffer=(cov_1cqvgzuehr.s[8]++,require('buffer').Buffer);// Allow {CLIENT_RENEG_LIMIT} client-initiated session renegotiations
// every {CLIENT_RENEG_WINDOW} seconds. An error event is emitted if more
// renegotiations are seen. The settings are applied to all remote client
// connections.
cov_1cqvgzuehr.s[9]++;exports.CLIENT_RENEG_LIMIT=3;cov_1cqvgzuehr.s[10]++;exports.CLIENT_RENEG_WINDOW=600;cov_1cqvgzuehr.s[11]++;exports.SLAB_BUFFER_SIZE=10*1024*1024;cov_1cqvgzuehr.s[12]++;exports.DEFAULT_CIPHERS=process.binding('constants').crypto.defaultCipherList;cov_1cqvgzuehr.s[13]++;exports.DEFAULT_ECDH_CURVE='prime256v1';cov_1cqvgzuehr.s[14]++;exports.getCiphers=internalUtil.cachedResult(()=>{cov_1cqvgzuehr.f[0]++;cov_1cqvgzuehr.s[15]++;return internalUtil.filterDuplicateStrings(binding.getSSLCiphers(),true);});// Convert protocols array into valid OpenSSL protocols list
// ("\x06spdy/2\x08http/1.1\x08http/1.0")
function convertProtocols(protocols){cov_1cqvgzuehr.f[1]++;const lens=(cov_1cqvgzuehr.s[16]++,new Array(protocols.length));const buff=(cov_1cqvgzuehr.s[17]++,Buffer.allocUnsafe(protocols.reduce((p,c,i)=>{cov_1cqvgzuehr.f[2]++;var len=(cov_1cqvgzuehr.s[18]++,Buffer.byteLength(c));cov_1cqvgzuehr.s[19]++;lens[i]=len;cov_1cqvgzuehr.s[20]++;return p+1+len;},0)));var offset=(cov_1cqvgzuehr.s[21]++,0);cov_1cqvgzuehr.s[22]++;for(var i=0,c=protocols.length;i<c;i++){cov_1cqvgzuehr.s[23]++;buff[offset++]=lens[i];cov_1cqvgzuehr.s[24]++;buff.write(protocols[i],offset);cov_1cqvgzuehr.s[25]++;offset+=lens[i];}cov_1cqvgzuehr.s[26]++;return buff;}cov_1cqvgzuehr.s[27]++;exports.convertNPNProtocols=function(protocols,out){cov_1cqvgzuehr.f[3]++;cov_1cqvgzuehr.s[28]++;// If protocols is Array - translate it into buffer
if(Array.isArray(protocols)){cov_1cqvgzuehr.b[0][0]++;cov_1cqvgzuehr.s[29]++;out.NPNProtocols=convertProtocols(protocols);}else{cov_1cqvgzuehr.b[0][1]++;cov_1cqvgzuehr.s[30]++;if(isUint8Array(protocols)){cov_1cqvgzuehr.b[1][0]++;cov_1cqvgzuehr.s[31]++;// Copy new buffer not to be modified by user.
out.NPNProtocols=Buffer.from(protocols);}else{cov_1cqvgzuehr.b[1][1]++;}}};cov_1cqvgzuehr.s[32]++;exports.convertALPNProtocols=function(protocols,out){cov_1cqvgzuehr.f[4]++;cov_1cqvgzuehr.s[33]++;// If protocols is Array - translate it into buffer
if(Array.isArray(protocols)){cov_1cqvgzuehr.b[2][0]++;cov_1cqvgzuehr.s[34]++;out.ALPNProtocols=convertProtocols(protocols);}else{cov_1cqvgzuehr.b[2][1]++;cov_1cqvgzuehr.s[35]++;if(isUint8Array(protocols)){cov_1cqvgzuehr.b[3][0]++;cov_1cqvgzuehr.s[36]++;// Copy new buffer not to be modified by user.
out.ALPNProtocols=Buffer.from(protocols);}else{cov_1cqvgzuehr.b[3][1]++;}}};function unfqdn(host){cov_1cqvgzuehr.f[5]++;cov_1cqvgzuehr.s[37]++;return host.replace(/[.]$/,'');}function splitHost(host){cov_1cqvgzuehr.f[6]++;cov_1cqvgzuehr.s[38]++;// String#toLowerCase() is locale-sensitive so we use
// a conservative version that only lowercases A-Z.
const replacer=c=>{cov_1cqvgzuehr.f[7]++;cov_1cqvgzuehr.s[39]++;return String.fromCharCode(32+c.charCodeAt(0));};cov_1cqvgzuehr.s[40]++;return unfqdn(host).replace(/[A-Z]/g,replacer).split('.');}function check(hostParts,pattern,wildcards){cov_1cqvgzuehr.f[8]++;cov_1cqvgzuehr.s[41]++;// Empty strings, null, undefined, etc. never match.
if(!pattern){cov_1cqvgzuehr.b[4][0]++;cov_1cqvgzuehr.s[42]++;return false;}else{cov_1cqvgzuehr.b[4][1]++;}const patternParts=(cov_1cqvgzuehr.s[43]++,splitHost(pattern));cov_1cqvgzuehr.s[44]++;if(hostParts.length!==patternParts.length){cov_1cqvgzuehr.b[5][0]++;cov_1cqvgzuehr.s[45]++;return false;}else{cov_1cqvgzuehr.b[5][1]++;}// Pattern has empty components, e.g. "bad..example.com".
cov_1cqvgzuehr.s[46]++;if(patternParts.includes('')){cov_1cqvgzuehr.b[6][0]++;cov_1cqvgzuehr.s[47]++;return false;}else{cov_1cqvgzuehr.b[6][1]++;}// RFC 6125 allows IDNA U-labels (Unicode) in names but we have no
// good way to detect their encoding or normalize them so we simply
// reject them.  Control characters and blanks are rejected as well
// because nothing good can come from accepting them.
cov_1cqvgzuehr.s[48]++;const isBad=s=>{cov_1cqvgzuehr.f[9]++;cov_1cqvgzuehr.s[49]++;return /[^\u0021-\u007F]/u.test(s);};cov_1cqvgzuehr.s[50]++;if(patternParts.some(isBad)){cov_1cqvgzuehr.b[7][0]++;cov_1cqvgzuehr.s[51]++;return false;}else{cov_1cqvgzuehr.b[7][1]++;}// Check host parts from right to left first.
cov_1cqvgzuehr.s[52]++;for(var i=hostParts.length-1;i>0;i-=1){cov_1cqvgzuehr.s[53]++;if(hostParts[i]!==patternParts[i]){cov_1cqvgzuehr.b[8][0]++;cov_1cqvgzuehr.s[54]++;return false;}else{cov_1cqvgzuehr.b[8][1]++;}}const hostSubdomain=(cov_1cqvgzuehr.s[55]++,hostParts[0]);const patternSubdomain=(cov_1cqvgzuehr.s[56]++,patternParts[0]);const patternSubdomainParts=(cov_1cqvgzuehr.s[57]++,patternSubdomain.split('*'));// Short-circuit when the subdomain does not contain a wildcard.
// RFC 6125 does not allow wildcard substitution for components
// containing IDNA A-labels (Punycode) so match those verbatim.
cov_1cqvgzuehr.s[58]++;if((cov_1cqvgzuehr.b[10][0]++,patternSubdomainParts.length===1)||(cov_1cqvgzuehr.b[10][1]++,patternSubdomain.includes('xn--'))){cov_1cqvgzuehr.b[9][0]++;cov_1cqvgzuehr.s[59]++;return hostSubdomain===patternSubdomain;}else{cov_1cqvgzuehr.b[9][1]++;}cov_1cqvgzuehr.s[60]++;if(!wildcards){cov_1cqvgzuehr.b[11][0]++;cov_1cqvgzuehr.s[61]++;return false;}else{cov_1cqvgzuehr.b[11][1]++;}// More than one wildcard is always wrong.
cov_1cqvgzuehr.s[62]++;if(patternSubdomainParts.length>2){cov_1cqvgzuehr.b[12][0]++;cov_1cqvgzuehr.s[63]++;return false;}else{cov_1cqvgzuehr.b[12][1]++;}// *.tld wildcards are not allowed.
cov_1cqvgzuehr.s[64]++;if(patternParts.length<=2){cov_1cqvgzuehr.b[13][0]++;cov_1cqvgzuehr.s[65]++;return false;}else{cov_1cqvgzuehr.b[13][1]++;}const[prefix,suffix]=(cov_1cqvgzuehr.s[66]++,patternSubdomainParts);cov_1cqvgzuehr.s[67]++;if(prefix.length+suffix.length>hostSubdomain.length){cov_1cqvgzuehr.b[14][0]++;cov_1cqvgzuehr.s[68]++;return false;}else{cov_1cqvgzuehr.b[14][1]++;}cov_1cqvgzuehr.s[69]++;if(!hostSubdomain.startsWith(prefix)){cov_1cqvgzuehr.b[15][0]++;cov_1cqvgzuehr.s[70]++;return false;}else{cov_1cqvgzuehr.b[15][1]++;}cov_1cqvgzuehr.s[71]++;if(!hostSubdomain.endsWith(suffix)){cov_1cqvgzuehr.b[16][0]++;cov_1cqvgzuehr.s[72]++;return false;}else{cov_1cqvgzuehr.b[16][1]++;}cov_1cqvgzuehr.s[73]++;return true;}cov_1cqvgzuehr.s[74]++;exports.checkServerIdentity=function checkServerIdentity(host,cert){cov_1cqvgzuehr.f[10]++;const subject=(cov_1cqvgzuehr.s[75]++,cert.subject);const altNames=(cov_1cqvgzuehr.s[76]++,cert.subjectaltname);const dnsNames=(cov_1cqvgzuehr.s[77]++,[]);const uriNames=(cov_1cqvgzuehr.s[78]++,[]);const ips=(cov_1cqvgzuehr.s[79]++,[]);cov_1cqvgzuehr.s[80]++;host=''+host;cov_1cqvgzuehr.s[81]++;if(altNames){cov_1cqvgzuehr.b[17][0]++;cov_1cqvgzuehr.s[82]++;for(const name of altNames.split(', ')){cov_1cqvgzuehr.s[83]++;if(name.startsWith('DNS:')){cov_1cqvgzuehr.b[18][0]++;cov_1cqvgzuehr.s[84]++;dnsNames.push(name.slice(4));}else{cov_1cqvgzuehr.b[18][1]++;cov_1cqvgzuehr.s[85]++;if(name.startsWith('URI:')){cov_1cqvgzuehr.b[19][0]++;const uri=(cov_1cqvgzuehr.s[86]++,url.parse(name.slice(4)));cov_1cqvgzuehr.s[87]++;uriNames.push(uri.hostname);// TODO(bnoordhuis) Also use scheme.
}else{cov_1cqvgzuehr.b[19][1]++;cov_1cqvgzuehr.s[88]++;if(name.startsWith('IP Address:')){cov_1cqvgzuehr.b[20][0]++;cov_1cqvgzuehr.s[89]++;ips.push(name.slice(11));}else{cov_1cqvgzuehr.b[20][1]++;}}}}}else{cov_1cqvgzuehr.b[17][1]++;}let valid=(cov_1cqvgzuehr.s[90]++,false);let reason=(cov_1cqvgzuehr.s[91]++,'Unknown reason');cov_1cqvgzuehr.s[92]++;if(net.isIP(host)){cov_1cqvgzuehr.b[21][0]++;cov_1cqvgzuehr.s[93]++;valid=ips.includes(host);cov_1cqvgzuehr.s[94]++;if(!valid){cov_1cqvgzuehr.b[22][0]++;cov_1cqvgzuehr.s[95]++;reason=`IP: ${host} is not in the cert's list: ${ips.join(', ')}`;}else{cov_1cqvgzuehr.b[22][1]++;}// TODO(bnoordhuis) Also check URI SANs that are IP addresses.
}else{cov_1cqvgzuehr.b[21][1]++;cov_1cqvgzuehr.s[96]++;if(subject){cov_1cqvgzuehr.b[23][0]++;cov_1cqvgzuehr.s[97]++;host=unfqdn(host);// Remove trailing dot for error messages.
const hostParts=(cov_1cqvgzuehr.s[98]++,splitHost(host));cov_1cqvgzuehr.s[99]++;const wildcard=pattern=>{cov_1cqvgzuehr.f[11]++;cov_1cqvgzuehr.s[100]++;return check(hostParts,pattern,true);};cov_1cqvgzuehr.s[101]++;const noWildcard=pattern=>{cov_1cqvgzuehr.f[12]++;cov_1cqvgzuehr.s[102]++;return check(hostParts,pattern,false);};// Match against Common Name only if no supported identifiers are present.
cov_1cqvgzuehr.s[103]++;if((cov_1cqvgzuehr.b[25][0]++,dnsNames.length===0)&&(cov_1cqvgzuehr.b[25][1]++,ips.length===0)&&(cov_1cqvgzuehr.b[25][2]++,uriNames.length===0)){cov_1cqvgzuehr.b[24][0]++;const cn=(cov_1cqvgzuehr.s[104]++,subject.CN);cov_1cqvgzuehr.s[105]++;if(Array.isArray(cn)){cov_1cqvgzuehr.b[26][0]++;cov_1cqvgzuehr.s[106]++;valid=cn.some(wildcard);}else{cov_1cqvgzuehr.b[26][1]++;cov_1cqvgzuehr.s[107]++;if(cn){cov_1cqvgzuehr.b[27][0]++;cov_1cqvgzuehr.s[108]++;valid=wildcard(cn);}else{cov_1cqvgzuehr.b[27][1]++;}}cov_1cqvgzuehr.s[109]++;if(!valid){cov_1cqvgzuehr.b[28][0]++;cov_1cqvgzuehr.s[110]++;reason=`Host: ${host}. is not cert's CN: ${cn}`;}else{cov_1cqvgzuehr.b[28][1]++;}}else{cov_1cqvgzuehr.b[24][1]++;cov_1cqvgzuehr.s[111]++;valid=(cov_1cqvgzuehr.b[29][0]++,dnsNames.some(wildcard))||(cov_1cqvgzuehr.b[29][1]++,uriNames.some(noWildcard));cov_1cqvgzuehr.s[112]++;if(!valid){cov_1cqvgzuehr.b[30][0]++;cov_1cqvgzuehr.s[113]++;reason=`Host: ${host}. is not in the cert's altnames: ${altNames}`;}else{cov_1cqvgzuehr.b[30][1]++;}}}else{cov_1cqvgzuehr.b[23][1]++;cov_1cqvgzuehr.s[114]++;reason='Cert is empty';}}cov_1cqvgzuehr.s[115]++;if(!valid){cov_1cqvgzuehr.b[31][0]++;const err=(cov_1cqvgzuehr.s[116]++,new errors.Error('ERR_TLS_CERT_ALTNAME_INVALID',reason));cov_1cqvgzuehr.s[117]++;err.reason=reason;cov_1cqvgzuehr.s[118]++;err.host=host;cov_1cqvgzuehr.s[119]++;err.cert=cert;cov_1cqvgzuehr.s[120]++;return err;}else{cov_1cqvgzuehr.b[31][1]++;}};cov_1cqvgzuehr.s[121]++;exports.parseCertString=internalUtil.deprecate(internalTLS.parseCertString,'tls.parseCertString() is deprecated. '+'Please use querystring.parse() instead.','DEP0076');// Public API
cov_1cqvgzuehr.s[122]++;exports.createSecureContext=require('_tls_common').createSecureContext;cov_1cqvgzuehr.s[123]++;exports.SecureContext=require('_tls_common').SecureContext;cov_1cqvgzuehr.s[124]++;exports.TLSSocket=require('_tls_wrap').TLSSocket;cov_1cqvgzuehr.s[125]++;exports.Server=require('_tls_wrap').Server;cov_1cqvgzuehr.s[126]++;exports.createServer=require('_tls_wrap').createServer;cov_1cqvgzuehr.s[127]++;exports.connect=require('_tls_wrap').connect;// Deprecated: DEP0064
cov_1cqvgzuehr.s[128]++;exports.createSecurePair=require('_tls_legacy').createSecurePair;