// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
'use strict';var cov_4h5k5gcxm=function(){var path='vm.js',hash='6952fc7bf52b395a18c9169a04bd18e865a70578',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'vm.js',statementMap:{'0':{start:{line:31,column:4},end:{line:31,column:33}},'1':{start:{line:43,column:29},end:{line:43,column:62}},'2':{start:{line:44,column:25},end:{line:44,column:54}},'3':{start:{line:46,column:0},end:{line:52,column:2}},'4':{start:{line:47,column:2},end:{line:51,column:3}},'5':{start:{line:48,column:4},end:{line:48,column:69}},'6':{start:{line:50,column:4},end:{line:50,column:52}},'7':{start:{line:54,column:0},end:{line:61,column:2}},'8':{start:{line:55,column:2},end:{line:60,column:3}},'9':{start:{line:56,column:4},end:{line:57,column:62}},'10':{start:{line:59,column:4},end:{line:59,column:69}},'11':{start:{line:63,column:0},end:{line:66,column:2}},'12':{start:{line:64,column:16},end:{line:64,column:38}},'13':{start:{line:65,column:2},end:{line:65,column:45}},'14':{start:{line:69,column:2},end:{line:73,column:3}},'15':{start:{line:70,column:4},end:{line:70,column:17}},'16':{start:{line:71,column:9},end:{line:73,column:3}},'17':{start:{line:72,column:4},end:{line:72,column:19}},'18':{start:{line:75,column:2},end:{line:75,column:23}},'19':{start:{line:76,column:2},end:{line:76,column:17}},'20':{start:{line:80,column:2},end:{line:80,column:35}},'21':{start:{line:88,column:24},end:{line:88,column:46}},'22':{start:{line:90,column:2},end:{line:93,column:40}},'23':{start:{line:91,column:4},end:{line:91,column:46}},'24':{start:{line:93,column:4},end:{line:93,column:40}},'25':{start:{line:95,column:2},end:{line:95,column:39}},'26':{start:{line:97,column:2},end:{line:105,column:3}},'27':{start:{line:98,column:4},end:{line:98,column:40}},'28':{start:{line:102,column:4},end:{line:104,column:5}},'29':{start:{line:103,column:6},end:{line:103,column:46}},'30':{start:{line:109,column:2},end:{line:118,column:3}},'31':{start:{line:110,column:4},end:{line:113,column:6}},'32':{start:{line:115,column:4},end:{line:117,column:7}},'33':{start:{line:119,column:2},end:{line:120,column:48}},'34':{start:{line:124,column:2},end:{line:124,column:35}},'35':{start:{line:125,column:2},end:{line:134,column:3}},'36':{start:{line:126,column:4},end:{line:129,column:6}},'37':{start:{line:131,column:4},end:{line:133,column:7}},'38':{start:{line:135,column:2},end:{line:135,column:71}},'39':{start:{line:139,column:2},end:{line:139,column:63}},'40':{start:{line:142,column:0},end:{line:151,column:2}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:46,column:36},end:{line:46,column:37}},loc:{start:{line:46,column:54},end:{line:52,column:1}},line:46},'1':{name:'(anonymous_1)',decl:{start:{line:54,column:32},end:{line:54,column:33}},loc:{start:{line:54,column:71},end:{line:61,column:1}},line:54},'2':{name:'(anonymous_2)',decl:{start:{line:63,column:35},end:{line:63,column:36}},loc:{start:{line:63,column:62},end:{line:66,column:1}},line:63},'3':{name:'createContext',decl:{start:{line:68,column:9},end:{line:68,column:22}},loc:{start:{line:68,column:32},end:{line:77,column:1}},line:68},'4':{name:'createScript',decl:{start:{line:79,column:9},end:{line:79,column:21}},loc:{start:{line:79,column:37},end:{line:81,column:1}},line:79},'5':{name:'sigintHandlersWrap',decl:{start:{line:85,column:9},end:{line:85,column:27}},loc:{start:{line:85,column:52},end:{line:106,column:1}},line:85},'6':{name:'runInContext',decl:{start:{line:108,column:9},end:{line:108,column:21}},loc:{start:{line:108,column:58},end:{line:121,column:1}},line:108},'7':{name:'runInNewContext',decl:{start:{line:123,column:9},end:{line:123,column:24}},loc:{start:{line:123,column:49},end:{line:136,column:1}},line:123},'8':{name:'runInThisContext',decl:{start:{line:138,column:9},end:{line:138,column:25}},loc:{start:{line:138,column:41},end:{line:140,column:1}},line:138}},branchMap:{'0':{loc:{start:{line:47,column:2},end:{line:51,column:3}},type:'if',locations:[{start:{line:47,column:2},end:{line:51,column:3}},{start:{line:47,column:2},end:{line:51,column:3}}],line:47},'1':{loc:{start:{line:47,column:6},end:{line:47,column:64}},type:'binary-expr',locations:[{start:{line:47,column:6},end:{line:47,column:13}},{start:{line:47,column:17},end:{line:47,column:38}},{start:{line:47,column:42},end:{line:47,column:64}}],line:47},'2':{loc:{start:{line:55,column:2},end:{line:60,column:3}},type:'if',locations:[{start:{line:55,column:2},end:{line:60,column:3}},{start:{line:55,column:2},end:{line:60,column:3}}],line:55},'3':{loc:{start:{line:55,column:6},end:{line:55,column:64}},type:'binary-expr',locations:[{start:{line:55,column:6},end:{line:55,column:13}},{start:{line:55,column:17},end:{line:55,column:38}},{start:{line:55,column:42},end:{line:55,column:64}}],line:55},'4':{loc:{start:{line:69,column:2},end:{line:73,column:3}},type:'if',locations:[{start:{line:69,column:2},end:{line:73,column:3}},{start:{line:69,column:2},end:{line:73,column:3}}],line:69},'5':{loc:{start:{line:71,column:9},end:{line:73,column:3}},type:'if',locations:[{start:{line:71,column:9},end:{line:73,column:3}},{start:{line:71,column:9},end:{line:73,column:3}}],line:71},'6':{loc:{start:{line:90,column:2},end:{line:93,column:40}},type:'if',locations:[{start:{line:90,column:2},end:{line:93,column:40}},{start:{line:90,column:2},end:{line:93,column:40}}],line:90},'7':{loc:{start:{line:109,column:2},end:{line:118,column:3}},type:'if',locations:[{start:{line:109,column:2},end:{line:118,column:3}},{start:{line:109,column:2},end:{line:118,column:3}}],line:109},'8':{loc:{start:{line:125,column:2},end:{line:134,column:3}},type:'if',locations:[{start:{line:125,column:2},end:{line:134,column:3}},{start:{line:125,column:2},end:{line:134,column:3}}],line:125}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0},b:{'0':[0,0],'1':[0,0,0],'2':[0,0],'3':[0,0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const{ContextifyScript:Script,kParsingContext,makeContext,isContext,runInDebugContext}=(cov_4h5k5gcxm.s[0]++,process.binding('contextify'));// The binding provides a few useful primitives:
// - Script(code, { filename = "evalmachine.anonymous",
//                  displayErrors = true } = {})
//   with methods:
//   - runInThisContext({ displayErrors = true } = {})
//   - runInContext(sandbox, { displayErrors = true, timeout = undefined } = {})
// - makeContext(sandbox)
// - isContext(sandbox)
// From this we build the entire documented API.
const realRunInThisContext=(cov_4h5k5gcxm.s[1]++,Script.prototype.runInThisContext);const realRunInContext=(cov_4h5k5gcxm.s[2]++,Script.prototype.runInContext);cov_4h5k5gcxm.s[3]++;Script.prototype.runInThisContext=function(options){cov_4h5k5gcxm.f[0]++;cov_4h5k5gcxm.s[4]++;if((cov_4h5k5gcxm.b[1][0]++,options)&&(cov_4h5k5gcxm.b[1][1]++,options.breakOnSigint)&&(cov_4h5k5gcxm.b[1][2]++,process._events.SIGINT)){cov_4h5k5gcxm.b[0][0]++;cov_4h5k5gcxm.s[5]++;return sigintHandlersWrap(realRunInThisContext,this,[options]);}else{cov_4h5k5gcxm.b[0][1]++;cov_4h5k5gcxm.s[6]++;return realRunInThisContext.call(this,options);}};cov_4h5k5gcxm.s[7]++;Script.prototype.runInContext=function(contextifiedSandbox,options){cov_4h5k5gcxm.f[1]++;cov_4h5k5gcxm.s[8]++;if((cov_4h5k5gcxm.b[3][0]++,options)&&(cov_4h5k5gcxm.b[3][1]++,options.breakOnSigint)&&(cov_4h5k5gcxm.b[3][2]++,process._events.SIGINT)){cov_4h5k5gcxm.b[2][0]++;cov_4h5k5gcxm.s[9]++;return sigintHandlersWrap(realRunInContext,this,[contextifiedSandbox,options]);}else{cov_4h5k5gcxm.b[2][1]++;cov_4h5k5gcxm.s[10]++;return realRunInContext.call(this,contextifiedSandbox,options);}};cov_4h5k5gcxm.s[11]++;Script.prototype.runInNewContext=function(sandbox,options){cov_4h5k5gcxm.f[2]++;var context=(cov_4h5k5gcxm.s[12]++,createContext(sandbox));cov_4h5k5gcxm.s[13]++;return this.runInContext(context,options);};function createContext(sandbox){cov_4h5k5gcxm.f[3]++;cov_4h5k5gcxm.s[14]++;if(sandbox===undefined){cov_4h5k5gcxm.b[4][0]++;cov_4h5k5gcxm.s[15]++;sandbox={};}else{cov_4h5k5gcxm.b[4][1]++;cov_4h5k5gcxm.s[16]++;if(isContext(sandbox)){cov_4h5k5gcxm.b[5][0]++;cov_4h5k5gcxm.s[17]++;return sandbox;}else{cov_4h5k5gcxm.b[5][1]++;}}cov_4h5k5gcxm.s[18]++;makeContext(sandbox);cov_4h5k5gcxm.s[19]++;return sandbox;}function createScript(code,options){cov_4h5k5gcxm.f[4]++;cov_4h5k5gcxm.s[20]++;return new Script(code,options);}// Remove all SIGINT listeners and re-attach them after the wrapped function
// has executed, so that caught SIGINT are handled by the listeners again.
function sigintHandlersWrap(fn,thisArg,argsArray){cov_4h5k5gcxm.f[5]++;// Using the internal list here to make sure `.once()` wrappers are used,
// not the original ones.
let sigintListeners=(cov_4h5k5gcxm.s[21]++,process._events.SIGINT);cov_4h5k5gcxm.s[22]++;if(Array.isArray(sigintListeners)){cov_4h5k5gcxm.b[6][0]++;cov_4h5k5gcxm.s[23]++;sigintListeners=sigintListeners.slice();}else{cov_4h5k5gcxm.b[6][1]++;cov_4h5k5gcxm.s[24]++;sigintListeners=[sigintListeners];}cov_4h5k5gcxm.s[25]++;process.removeAllListeners('SIGINT');cov_4h5k5gcxm.s[26]++;try{cov_4h5k5gcxm.s[27]++;return fn.apply(thisArg,argsArray);}finally{cov_4h5k5gcxm.s[28]++;// Add using the public methods so that the `newListener` handler of
// process can re-attach the listeners.
for(const listener of sigintListeners){cov_4h5k5gcxm.s[29]++;process.addListener('SIGINT',listener);}}}function runInContext(code,contextifiedSandbox,options){cov_4h5k5gcxm.f[6]++;cov_4h5k5gcxm.s[30]++;if(typeof options==='string'){cov_4h5k5gcxm.b[7][0]++;cov_4h5k5gcxm.s[31]++;options={filename:options,[kParsingContext]:contextifiedSandbox};}else{cov_4h5k5gcxm.b[7][1]++;cov_4h5k5gcxm.s[32]++;options=Object.assign({},options,{[kParsingContext]:contextifiedSandbox});}cov_4h5k5gcxm.s[33]++;return createScript(code,options).runInContext(contextifiedSandbox,options);}function runInNewContext(code,sandbox,options){cov_4h5k5gcxm.f[7]++;cov_4h5k5gcxm.s[34]++;sandbox=createContext(sandbox);cov_4h5k5gcxm.s[35]++;if(typeof options==='string'){cov_4h5k5gcxm.b[8][0]++;cov_4h5k5gcxm.s[36]++;options={filename:options,[kParsingContext]:sandbox};}else{cov_4h5k5gcxm.b[8][1]++;cov_4h5k5gcxm.s[37]++;options=Object.assign({},options,{[kParsingContext]:sandbox});}cov_4h5k5gcxm.s[38]++;return createScript(code,options).runInNewContext(sandbox,options);}function runInThisContext(code,options){cov_4h5k5gcxm.f[8]++;cov_4h5k5gcxm.s[39]++;return createScript(code,options).runInThisContext(options);}cov_4h5k5gcxm.s[40]++;module.exports={Script,createContext,createScript,runInDebugContext,runInContext,runInNewContext,runInThisContext,isContext};