'use strict';

const { isMainThread, mustCall, mustNotCall, skip, isWindows } = require('../common');
const { strictEqual } = require('assert');

if (!isMainThread) {
  skip('process.execve is not available in Workers');
} else if (isWindows) {
  skip('process.execve is not available in Windows');
}

if (process.argv[2] === 'replaced') {
  process.on('beforeExit', mustCall());
  strictEqual(process.argv[2], 'replaced');
} else {
  process.on('beforeExit', mustNotCall());
  process.execve(process.execPath, [__filename, 'replaced']);
}
